<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="InsaDao">


	<insert id="insertTest">
		<![CDATA[
			INSERT INTO TEST
			VALUES(NVL(#{id}, ''))
		]]>
		
	</insert>

	<insert id="insertInsa">
		<![CDATA[
			INSERT INTO INSA (SABUN, NAME, REG_NO,
				HP, ID, PWD, ENG_NAME, PHONE, AGE, EMAIL,
				JOIN_GBN_CODE, SEX, ZIP, ADDR1, ADDR2, POS_GBN_CODE,
				DEPT_CODE, SALARY, GART_LEVEL, PUT_YN, MIL_YN, 
				MIL_TYPE, MIL_LEVEL, MIL_STARTDATE, MIL_ENDDATE,
				KOSA_REG_YN, KOSA_CLASS_CODE, JOIN_DAY, RETIRE_DAY, 
				CMP_REG_NO, CRM_NAME, CMP_REG_IMAGE, CARRIER_IMAGE, 
				PROFILE_IMAGE, SELF_INTRO, JOIN_YN)
			VALUES((SELECT NVL(MAX(SABUN), 10000) + 1 FROM INSA), 
				#{name}, #{reg_no}, #{hp}, #{id}, #{pwd},
				#{eng_name}, #{phone}, #{age}, #{email}, #{join_gbn_code},
				#{sex}, #{zip}, #{addr1}, #{addr2}, #{pos_gbn_code}, 
				#{dept_code}, #{salary}, #{gart_level}, #{put_yn},
				#{mil_yn}, NVL(#{mil_type}, ''), NVL(#{mil_level}, ''), 
				NVL(#{mil_startdate}, ''), NVL(#{mil_enddate}, ''), 
				#{kosa_reg_yn}, nvl(#{kosa_class_code}, ''), 
				#{join_day}, #{retire_day}, #{cmp_reg_no}, #{crm_name},
				#{cmp_reg_image}, #{carrier_image}, #{profile_image},
				#{self_intro}, #{join_yn})			
		]]>
	</insert>

	<update id="updateInsa">
		<![CDATA[
			UPDATE INSA SET
				NAME = #{name}, REG_NO = #{reg_no},	HP = #{hp},
				PWD = #{pwd}, ENG_NAME = #{eng_name}, JOIN_YN = #{join_yn},
				PHONE = #{phone}, AGE = #{age}, EMAIL = #{email},
				JOIN_GBN_CODE = #{join_gbn_code}, SALARY = #{salary},
				GART_LEVEL = #{gart_level}, PUT_YN = #{put_yn}, 
				MIL_YN = #{mil_yn}, MIL_TYPE = #{mil_type}, 
				MIL_LEVEL = #{mil_level}, MIL_STARTDATE = #{mil_startdate},
				MIL_ENDDATE = #{mil_enddate}, KOSA_REG_YN = #{kosa_reg_yn},
				KOSA_CLASS_CODE = #{kosa_class_code}, JOIN_DAY = #{join_day},
				RETIRE_DAY = #{retire_day}, CMP_REG_NO = #{cmp_reg_no},
				CRM_NAME = #{crm_name}, SELF_INTRO = #{self_intro}
		]]>
				
		<if test="profile_image != null">
			, PROFILE_IMAGE = #{profile_image}		
		</if>
		<if test="carrier_image != null">
			, CARRIER_IMAGE = #{carrier_image}		
		</if>
		<if test="cmp_reg_image != null">
			, CMP_REG_IMAGE = #{cmp_reg_image}		
		</if>
		
		
		<![CDATA[
				WHERE SABUN = #{sabun}		
		]]>
		
	</update>

	<delete id="deleteInsa">
		<![CDATA[
			DELETE FROM INSA
			WHERE SABUN = #{sabun}
		]]>
	</delete>

	<select id="getMaxSabun" resultType="int">
		<![CDATA[
			SELECT NVL(MAX(SABUN), 100000) + 1
			FROM INSA
		]]>	
	</select>
	
	<select id="checkId" resultType="insa">
		<![CDATA[
			SELECT * FROM INSA
			WHERE ID = #{id}
		]]>
	</select>

	<select id="getInsa" resultType="insa">
		<![CDATA[
			SELECT * FROM INSA
			WHERE SABUN = #{sabun}
		]]>
	</select>


	<select id="getInsaListCnt" resultType="int">
		<![CDATA[
			SELECT COUNT(*)	FROM INSA
			WHERE 1 = 1
		]]>
		<if test="sabun != null">
			AND SABUN LIKE '%'||#{sabun}||'%'
		</if>
		<if test="name != null">
			AND NAME LIKE '%'||#{name}||'%'
		</if>		
		<if test="join_yn != null">
			AND JOIN_YN = #{join_yn}
		</if>
		<if test="join_yn == ''">
			OR JOIN_YN IS NULL
		</if>
		<![CDATA[
			ORDER BY SABUN
		]]>
	</select>
	
	
	<select id="getInsaList" resultType="insa">
		<![CDATA[
			SELECT ROWNUM, P.* FROM
				(SELECT ROWNUM AS RNUM, K.* FROM
					(SELECT SABUN, NAME, REG_NO, HP,
						POS_GBN_CODE, JOIN_DAY, RETIRE_DAY,
						PUT_YN, SALARY
					FROM INSA
					WHERE 1 = 1
		]]>
		
						<if test="sabun != null">
							AND SABUN LIKE '%'||#{sabun}||'%'
						</if>
						<if test="name != null">
							AND NAME LIKE '%'||#{name}||'%'
						</if>
						<if test="join_yn != null">
							AND JOIN_YN = #{join_yn}							
						</if>
						<if test="join_yn == ''">
							OR JOIN_YN IS NULL
						</if>
		
		<![CDATA[
					ORDER BY SABUN) K
				WHERE ROWNUM <= #{endRow}) P
			WHERE RNUM >= #{startRow}
		]]>
	</select>
	
	
	<insert id="insertBigTestData">
		<![CDATA[
			INSERT INTO INSA(SABUN, ID, PWD, REG_NO, HP, NAME)
			VALUES((SELECT NVL(MAX(SABUN), 100000) + 1 FROM INSA),
				#{id}, #{pwd}, #{reg_no}, #{hp}, #{name})				
		]]>
	</insert>

</mapper>